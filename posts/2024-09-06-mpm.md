---
title: 3D MPM Implementation
description: An adaptation of MPM liquid simulation in Unity
categories:
- graphics
- demos
published_date: 2024-09-06 20:14:39.070268759 +0000
layout: posts.liquid
is_draft: false
data:
  show_on_homepage: true
  thumbnail: /assets/graphics/MPM_thumbnail.png
---
<div class = "blog-post">
<br>
<div class = "title">
3D MPM Implementation
</div>

<div class = "page-summary">
A college project - implementing the MPM method in 3D using Unity
</div>
<hr>
<br>

The MPM method is a pretty effective way to simulate liquids or deformable solids. I adapted an existing 2D method to a 3D world for this demo. This was a college project, so time was limited, and I couldn't get every aspect perfect. For example, the parameters are not perfectly chosen - so there is infinite movement, which obviously shouldn't be possible. But there is also working interaction with a moveable object. You can see the github page for this project <a href = "https://github.com/blazecus/3D-Liquid-MPM">here</a>.


<div class = "bg-div">
<br>
<table class = "image-table">
<th>
<iframe width = 100% height = 700px
src="https://www.youtube.com/embed/6VQqMkqwCZU">
</iframe>
</th>
</table>
<br>
Demo video
<br>
<br>
</div>
<br>
<br>
I based this project on a <a href = "https://github.com/nialltl/incremental_mpm">2D implementation</a> of the Multiple by nialltl. They also wrote a guide <a href = "https://nialltl.neocities.org/articles/mpm_guide">here</a>. There's more work to do on this type of project, although my next demo would be implemented from scratch. I also always wanted to apply some rendering techniques to the sphere outputs to make it actually look like liquid. Nvidia has some <a href = "https://developer.download.nvidia.com/presentations/2010/gdc/Direct3D_Effects.pdf">resources</a> on how you can do that - I spent a while trying to figure it out in Unity, but it had some build it limitations on what you can do with screen-space shaders and the depth buffer, so I couldn't get it working in the end. Next time, built from scratch, this should be possible. 

<br>

MPM is an interesting method for simulation. It was made famous by its use in Frozen and the accompanying <a href = "https://media.disneyanimation.com/uploads/production/publication_asset/94/asset/SSCTS13_2.pdf">Disney paper</a>, but has been advanced over the years. I've seen some impressive implementations of the method - for example, <a href="https://www.youtube.com/watch?v=4Y58Pg9tpSo">John Lin's single core liquid simulation</a>, but I've yet to see it truly implemented within a game engine. It remains fairly expensive, with few gameplay benefits, so far at least. It has some promise, even if it only works as a visual effect in games. Water is ultimately hard to figure out as a gameplay mechanic, especially if it is truly realistic - but I have a few ideas for MPM-related gameplay mechanics.  

This project wasn't my only project that used MPM, actually. I had another college project, that ultimately failed, with a goal of using another implementation of MPM (<a href = "https://github.com/yuanming-hu/taichi_mpm">Taichi</a>) to simulate how metal deforms when forged, which could allow people to plan deformation patterns for something like Damascus steel.

<br>
<div class = "bg-div">
<br>
<table class = "image-table">
<th><img src="/assets/graphics/mpm2d.png"></th>
</table>
<br>
nialltl's implementation
<br>
<br>
</div>

<div class = "bg-div">
<br>
<table class = "image-table">
<th><img src="/assets/graphics/MPM_thumbnail.png"></th>
</table>
<br>
Screenshot from the demo video
<br>
<br>
</div>

</div>